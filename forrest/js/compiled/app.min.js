$(document).ready(function(){var e,n="8PyTZKuJ1VEQWvDvoOsARLkT8f6N71db",t="https://api.behance.net/v2/users/",a="https://www.behance.net/v2/projects/",o=["codycobb","ashthorp","Filiphds"],s={projectsPerPage:3,nextPageNumber:1},r={commentsPerPage:5,nextPageNumber:1},i=[],c=$(".projects").masonry({itemSelector:".project",columnWidth:".sizer",percentPosition:!0});function l(e,o){var n=$.ajax({method:"GET",dataType:"jsonp",url:e,success:function(e){for(var t=0;t<i.length;t++)i[t]==n&&i.splice(t,1);o(e)},error:function(e){throw new Error("Unhandled AJAX Error: ",e)}});i.push(n)}function m(t,o){l(a+t+"?api_key="+n,function(e){!function(e){console.log(e);for(var t=e.project,o=$("#projectDetailsTemplate").html(),n=Template7.compile(o),a={articles:[],fields:[],fieldsString:"",description:t.description,creationDate:moment.unix(t.published_on).format("Do MMM YYYY"),projectName:t.name,stats:{likes:t.stats.appreciations,views:t.stats.views,comments:t.stats.comments},projectID:t.id,behanceURL:t.url},s=0;s<t.modules.length;s++){var r=t.modules[s];switch(r.type){case"image":a.articles.push(r.sizes.max_1200);break;case"media_collection":for(var i=r.components,l=0;l<i.length;l++)a.articles.push(i[l].sizes.max_1200);break;default:console.log("No support has been added for this data type: "+r.type)}}for(var c=0;c<t.fields.length;c++)a.fields.push(t.fields[c]),a.fieldsString+=a.fields[c],c<t.fields.length-1&&(a.fieldsString+=", ");var m=n(a);$("#modalContent").append(m),$("#images").slick({initialSlide:1,slidesToShow:1,slidesToScroll:1,infinite:!0,adaptiveHeight:!1,arrows:!0,prevArrow:"<i class='slick-prev fa fa-angle-left'>Previous</i>",nextArrow:"<i class='slick-next fa fa-angle-right'>Right</i>",responsive:[{breakpoint:1e3,settings:{adaptiveHeight:!0,arrows:!1}}]}),$(window).trigger("resize")}(e),p(t),o&&o()})}function p(e){l(a+e+"/comments?client_id="+n+"&per_page="+r.commentsPerPage+"&page="+r.nextPageNumber,function(e){0<e.comments.length?(!function(e){console.log(e);var t=e.comments,o=[];if(0<e.comments.length)for(var n=0;n<t.length;n++){var a=t[n],s=$("#commentTemplate").html(),r=Template7.compile(s),i={commenter:{name:a.user.display_name,image:a.user.images[115],link:a.user.url},comment:a.comment,publishedOn:moment.unix(a.created_on).format("Do MMM YYYY")},l=r(i);o.push(l),t.length==o.length&&$("#comments").append(o)}}(e),r.nextPageNumber++,$("#loadMoreComments").removeClass("disabledButton")):$("#loadMoreComments").hide()})}function d(e){console.log(e);var t=e.projects,o=$(".project").length;if(0<t.length){for(var n=0;n<t.length;n++){o+=1;var a=$("#projectTemplate").html(),s=Template7.compile(a),r={coverImage:t[n].covers.original,projectName:t[n].name,stats:{likes:t[n].stats.appreciations,views:t[n].stats.views,comments:t[n].stats.comments},projectID:t[n].id,creator:null,counter:o};1<t[n].owners.length?r.creator="Multiple Owners":r.creator=t[n].owners[0].display_name;var i=s(r),l=$(i);c.append(l).masonry("appended",l)}c.imagesLoaded().progress(function(){c.masonry("layout")})}}function u(){$("#loader").fadeToggle({duration:300,easing:"swing"})}function g(e){$("#modalMask").fadeToggle({duration:300,easing:"swing",complete:e})}function f(){$("body").toggleClass("modalShowing")}function h(){s.nextPageNumber=1,r.nextPageNumber=1,f(),g(function(){$("#modalContent").empty()})}e=s.nextPageNumber,l(t+o[0]+"/projects?client_id="+n+"&per_page="+s.projectsPerPage+"&page="+e,d),s.nextPageNumber++,$(document).on("click",".projectInner",function(e){e.preventDefault(),u(),g(),m(this.dataset.projectid,u),f()}),$(document).on("click","#modalMask",function(e){e.target==e.currentTarget&&h()}),$(".closeWrapper").on("click",function(){h()}),$(document).on("click","#loadMoreComments",function(e){e.preventDefault(),$(this).hasClass("disabledButton")||($("#loadMoreComments").addClass("disabledButton"),p(this.dataset.projectid))})});