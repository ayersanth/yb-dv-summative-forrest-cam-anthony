$(document).ready(function(){var e,o="8PyTZKuJ1VEQWvDvoOsARLkT8f6N71db",t="https://api.behance.net/v2/users/",a="https://www.behance.net/v2/projects/",n=["codycobb","ashthorp","Filiphds"],s={projectsPerPage:3,nextPageNumber:1},i={commentsPerPage:5,nextPageNumber:1},l=$(".projects").masonry({itemSelector:".project",columnWidth:".sizer",percentPosition:!0});function r(e,t){$.ajax({method:"GET",dataType:"jsonp",url:e,success:t,error:function(e){throw new Error("Unhandled AJAX Error: ",e)}})}function c(t,n){r(a+t+"?api_key="+o,function(e){!function(e){console.log(e);for(var t=e.project,n=$("#projectDetailsTemplate").html(),o=Template7.compile(n),a={images:[],fields:[],fieldsString:"",description:t.description,creationDate:moment.unix(t.published_on).format("Do MMM YYYY"),projectName:t.name,stats:{likes:t.stats.appreciations,views:t.stats.views,comments:t.stats.comments},projectID:t.id},s=0;s<t.modules.length;s++)"image"==t.modules[s].type&&a.images.push(t.modules[s].sizes.max_1200);for(var i=0;i<t.fields.length;i++)a.fields.push(t.fields[i]),a.fieldsString+=a.fields[i],i<t.fields.length-1&&(a.fieldsString+=", ");var r=o(a);$("#modalContent").append(r),$("#images").slick({initialSlide:1,slidesToShow:1,slidesToScroll:1,infinite:!0,adaptiveHeight:!1,arrows:!0,prevArrow:"<i class='slick-prev fa fa-angle-left'>Previous</i>",nextArrow:"<i class='slick-next fa fa-angle-right'>Right</i>",responsive:[{breakpoint:1e3,settings:{adaptiveHeight:!0,arrows:!1}}]}),$(window).trigger("resize")}(e),m(t),n&&n()})}function m(e){r(a+e+"/comments?client_id="+o+"&per_page="+i.commentsPerPage+"&page="+i.nextPageNumber,function(e){0<e.comments.length?(!function(e){console.log(e);var t=e.comments,n=[];if(0<e.comments.length)for(var o=0;o<t.length;o++){var a=t[o],s=$("#commentTemplate").html(),i=Template7.compile(s),r={commenter:{name:a.user.display_name,image:a.user.images[115],link:a.user.url},comment:a.comment,publishedOn:moment.unix(a.created_on).format("Do MMM YYYY")},c=i(r);n.push(c),t.length==n.length&&$("#comments").append(n)}}(e),i.nextPageNumber++):$("#loadMoreComments").hide()})}function p(e){console.log(e);var t=e.projects,n=$(".project").length;if(0<t.length){for(var o=0;o<t.length;o++){n+=1;var a=$("#projectTemplate").html(),s=Template7.compile(a),i={coverImage:t[o].covers.original,projectName:t[o].name,stats:{likes:t[o].stats.appreciations,views:t[o].stats.views,comments:t[o].stats.comments},projectID:t[o].id,creator:null,counter:n};1<t[o].owners.length?i.creator="Multiple Owners":i.creator=t[o].owners[0].display_name;var r=s(i),c=$(r);l.append(c).masonry("appended",c)}l.imagesLoaded().progress(function(){l.masonry("layout")})}}function d(){$("#loader").fadeToggle({duration:300,easing:"swing"})}function g(e){$("#modalMask").fadeToggle({duration:300,easing:"swing",complete:e})}function u(){$("body").toggleClass("modalShowing")}function f(){s.nextPageNumber=1,i.nextPageNumber=1,u(),g(function(){$("#modalContent").empty()})}e=s.nextPageNumber,r(t+n[0]+"/projects?client_id="+o+"&per_page="+s.projectsPerPage+"&page="+e,p),s.nextPageNumber++,$(document).on("click",".projectInner",function(e){e.preventDefault(),d(),g(),c(this.parentNode.dataset.projectid,d),u()}),$(document).on("click","#modalMask",function(e){e.target==e.currentTarget&&f()}),$(".closeWrapper").on("click",function(){f()}),$(document).on("click",".loadMoreComments",function(e){e.preventDefault(),m(this.dataset.projectid)})});